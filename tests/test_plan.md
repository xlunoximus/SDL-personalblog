# План тестирования — PersonalBlog

## 1. Общая информация

Этот документ определяет стратегию тестирования, окружение и цели для веб-приложения PersonalBlog — платформы для создания, публикации и просмотра постов, построенной на Spring Boot (Java), JPA/Hibernate, Thymeleaf и JavaScript.

**Цель тестирования** — проверить все backend контроллеры, логику аутентификации и авторизации (JWT), работу с сущностями Post и Comment (CRUD), интеграцию с базой данных и корректность работы frontend-части.

## 2. Цели тестирования

*   Проверить функциональную корректность всех контроллеров (`/`, `/register`, `/login`, `/posts`, `/posts/{id}`, `/comments`, `/my-posts`).
*   Убедиться в корректной работе CRUD операций для сущностей Post и Comment.
*   Проверить валидацию данных на уровне сервисов и контроллеров.
*   Оценить стабильность системы и обработку ошибок (например, 404, 403, 500).
*   Проверить корректность отображения данных на UI (Thymeleaf шаблоны).

## 3. Область тестирования

**В области тестирования:**
*   Юнит и интеграционные тесты для всех Spring контроллеров (`PostController`, `CommentController`, `AuthController`).
*   Логика аутентификации и авторизации (SecurityConfig, JWTFilter, UserService).
*   Бизнес-логика сервисов (`PostService`, `CommentService`, `UserService`).
*   Работа репозиториев (`PostRepository`, `CommentRepository`, `UserRepository`) с базой данных (JPA).
*   Отображение данных через Thymeleaf шаблоны.
*   JavaScript функционал (если есть, например, для динамического добавления комментариев).

**Вне области тестирования:**
*   UI тестирование (обрабатывается вручную или с помощью инструментов вроде Selenium, если планируется).
*   Нагрузочное тестирование (планируется на следующем этапе).
*   Интеграция с внешними API (если не планируется в текущем scope).

## 4. Стратегия тестирования

Тестирование будет выполняться с использованием автоматизированного тестирования на базе JUnit 5 и Mockito/MockMvc для backend-части.

**Фреймворки и инструменты:**
| Тип             | Инструмент        |
| :-------------- | :---------------- |
| Тест-раннер     | JUnit 5           |
| Мокирование     | Mockito           |
| Веб-тестирование| MockMvc            |
| Сборка          | Maven / Gradle    |
| Фреймворк       | Spring Boot       |
| ORM             | JPA / Hibernate   |
| Покрытие кода   | JaCoCo (планируется) |
| База данных     | H2 (для тестов) / PostgreSQL/MySQL (prod) |

## 5. Тестовое окружение

| Компонент       | Технология / Примечание |
| :-------------- | :---------------------- |
| ОС              | Windows 11 / Linux      |
| Backend         | Spring Boot (Java)      |
| Frontend        | HTML5, CSS3, JavaScript |
| Шаблонизатор    | Thymeleaf               |
| База данных     | H2 (для тестов), PostgreSQL/MySQL (продакшн) |
| Порт            | 8080 (по умолчанию)     |

## 6. Типы тестов и покрытие

| Тип                         | Назначение                                                      |
| :-------------------------- | :-------------------------------------------------------------- |
| Юнит-тесты                  | Проверка изолированной логики сервисов и моделей (Entity).       |
| Интеграционные тесты контроллеров | Валидация HTTP маршрутов, статусов ответов и бизнес-потоков. |
| Тесты CRUD операций         | Проверка создания, чтения, обновления и удаления постов/комментариев. |
| Тесты валидации            | Проверка корректности валидации входных данных (например, `@Valid`). |
| Тесты репозиториев          | Проверка запросов к базе данных.                                |

## 7. Риски и меры по их снижению

| Риск                              | Меры по снижению                                                 |
| :-------------------------------- | :--------------------------------------------------------------- |
| Ошибки валидации на стороне клиента | Повторить валидацию на сервере.                                  |
| Проблемы с безопасностью (SQL-инъекции, XSS) | Использовать JPA/Hibernate, экранирование Thymeleaf, фильтры безопасности. |
| Ошибки в логике бизнес-слоя       | Покрытие юнит-тестами.                                           |
| Недоступность базы данных        | Использование H2 базы данных для тестов.                         |

✅ **Уровень риска:** Низкий–Средний

## 8. Критерии входа и выхода

**Критерии входа:**
*   Все зависимости (Maven/Gradle) установлены.
*   Spring Boot приложение компилируется без ошибок.
*   Доступна тестовая база данных (H2).

**Критерии выхода:**
*   Все тесты выполнены успешно (или с допустимым количеством известных багов).
*   Критические и важные дефекты исправлены.
*   Все основные эндпоинты контроллеров возвращают корректные HTTP статусы и представления.
*   CRUD операции для постов и комментариев работают корректно.
*   Аутентификация и авторизация функционируют как ожидалось.

## 9. Отчетность и результаты

| Документ              | Описание                                |
| :-------------------- | :-------------------------------------- |
| Test plan.md          | Этот документ.                          |
| Test results.md       | Результаты выполнения тестов (фактические). |
| Testing summary.md    | Итоги и выводы тестирования.            |

## 10. Тестовые данные

**Тестовые посты:**
*   `Post 1` (Title: "Test Post", Content: "This is a test post.", Author: `user1`)
*   `Post 2` (Title: "", Content: "Content without title.", Author: `user1` - для теста валидации)

**Тестовые комментарии:**
*   `Comment 1` (Text: "Great post!", Post: `Post 1`, User: `reader1`)
*   `Comment 2` (Text: "", Post: `Post 1`, User: `reader1` - для теста валидации)

**Тестовые сценарии:**
*   Создание поста зарегистрированным.
*   Просмотр списка всех постов.
*   Просмотр деталей конкретного поста.
*   Добавление комментария к посту.
*   Редактирование поста владельцем.
*   Удаление поста владельцем.